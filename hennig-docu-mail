From: Christian Hennig <hennig@stat.math.ethz.ch>
To: Martin Maechler <maechler@stat.math.ethz.ch>
Subject: Re: Dein Vorschlag fuer Silhouette Docu?
Date: Thu, 5 Sep 2002 11:44:10 +0200 (CEST)

Lieber Martin,

ich habe jetzt noch nichts Konkretes formuliert, weil ich eigentlich schon
das Konzept der Verteilung der Information ueber die Hilfeseiten zu "pam",
"pam.object" und "plot.partition" schlecht finde, andererseits aber nicht
weiss, ob du bereit bist, das zu aendern, oder ob es aufgrund irgendeines
uebergeordneten Konzeptes so sein soll.

Was ich gut finden wuerde:

In der Hilfeseite zu pam:

Ersetzen:

  \code{pam} is fully described in chapter 2 of Kaufman and Rousseeuw (1990).
Compared to the k-means approach in \code{kmeans}, the function \code{pam} has
the following features: (a) it also accepts a dissimilarity matrix;
(b) it is more robust because it minimizes a sum of dissimilarities
instead of a sum of squared euclidean distances; (c) it provides a novel
graphical display, the silhouette plot (see \code{plot.partition})
which also allows to select the number of clusters.

Durch:

  \code{pam} is fully described in chapter 2 of Kaufman and Rousseeuw (1990).
Compared to the k-means approach in \code{kmeans}, the function \code{pam} has
the following features: (a) it also accepts a dissimilarity matrix;
(b) it is more robust because it minimizes a sum of dissimilarities
instead of a sum of squared euclidean distances; (c) it provides a novel
graphical display, the silhouette plot (see \code{plot.partition});
(d) it allows to select the number of clusters (see component
\code{silinfo} of the value of \code{pam.object}).

Begruendung:
Der Koeffizient zur Bestimmung der Anzahl der Cluster wird zwar im
Zusammenhang mit dem Silhouette-Plot eingefuehrt, der Plot wird aber weder
zur Berechnung gebraucht, noch um den Koeffizienten zu motivieren.

In der Hilfeseite zu pam.object (warum ist das nicht in der pam-Hilfe
integriert? Es nervt mich jedes Mal, staendig zwischen den beiden Seiten
wechseln zu muessen):

Unter silinfo beim value sollten
1) die Namen aller Unterkomponenten (widths, clus.avg.widths und avg.width)
   genannt werden,
2) m.E. sollte die komplette Erklaerung der Indizes von der Help-Seite zu
   plot.partition nach pam.object verlegt werden (es nervt, erst nach
   plot.partition verweisen zu werden und dann doch pam.object lesen zu
   muessen, um wirklich herauszubekommen, wie es geht).
3) pam.object sollte vielleicht ein Beispiel enthalten, wie man das macht
   (und ggf. die Erklaerung, dass es oft nicht toll ist):

# Erzeugung *meiner* Testdaten siehe unten; man kann aber natuerlich welche
# nehmen, die das Verfahren besser aussehen lassen. Implizite
# Voraussetzung ist: alle Cluster sphaerisch mit selber Varianz. So sind
# meine Testdaten natuerlich nicht...
pams <- list()
avsilwidth <- c()
maxk <- 15
for(k in 2:maxk){
  pams[[k]] <- pam(test,k)
  avsilwidth <- c(avsilwidth,pams[[k]]$silinfo$avg.width)
}
kopt <- order(avsilwidth)[maxcn-1]+1
   
# Erzeugung der Testdaten; etwas kompliziert, da ich die Funktion fuer
# einen anderen Zweck geschrieben habe:

normaldata <- function(n=200,center=c(2,0),sigma=c(2,2)){
  require(mvtnorm)
  out <- rmvnorm(n, center, diag(sigma*sigma))
  out
}

tdata <- function(n=200,center=c(2,0),sigma=c(2,2)){
  v1 <- rcauchy(n,center[1],sigma[1]/1.837337)
  v2 <- rcauchy(n,center[2],sigma[2]/1.837337)
  # IQR wie bei N(0,1)
  out <- cbind(v1,v2)
  out
}

expdata <- function(n=200,center=c(0,0),sigma=c(1,1)){
  lambda <- 1/sigma
  foot <- center-sigma
  v1 <- foot[1]+rexp(n,lambda[1])
  v2 <- foot[2]+rexp(n,lambda[2])
  out <- cbind(v1,v2)
  out
}

normixdata <- function(nsub=20,subclasses=9,meanvec=1:5){
  # sigmas sind quadratisch!
  require(mvtnorm)
  sigmasq <- diag(c(0.0625,0.0625))
  nr <- ntot <- nsub*subclasses
  out <- matrix(nrow=ntot,ncol=2)
  rpt <- 1:ntot
  for (i in 1:subclasses){
    m <- c(sample(meanvec,1),sample(meanvec,1))
    pts <- sample(nr,nsub)
    pt <- rpt[pts]
    out[pt,] <- rmvnorm(nsub,m,sigmasq)
    rpt <- rpt[-pts]
    nr <- nr-nsub
  }
  out
}

simdata <- function(n=c(100,200), cluster="normal", rest="t",
                    noise="normal", p=4){
  clustercenter <- c(0,0)
  clustersigma <- c(1,1)
  noisecenter <- 0
  noisesigma <-
    if (rest=="normal" | rest=="t") sqrt(2.5)
    else 1
  nnoise <- sum(n)
  if (cluster=="normal")
    cld12 <- normaldata(n[1],clustercenter,clustersigma)
  if (cluster=="t")
    cld12 <- tdata(n[1],clustercenter,clustersigma)
  if (cluster=="exp")
    cld12 <- -expdata(n[1])
  if (rest=="t")
    rd12 <- tdata(n[2])
  if (rest=="normal")
    rd12 <- normaldata(n[2])
  if (rest=="normal2")
    rd12 <- normaldata(n[2], center=c(0,1), sigma=c(1.5,0.5))
  if (rest=="exp")
    rd12 <- expdata(n[2])
  if (rest=="normix")
    rd12 <- normixdata(n[2]/10,subclasses=10,meanvec=-5:5)
  nd <- c()
  for (i in 1:(p-2)){
    if (noise=="t")
      nd <- cbind(nd,rcauchy(nnoise,noisecenter,noisesigma))
    if (noise=="normal")
      nd <- cbind(nd,rnorm(nnoise,noisecenter,noisesigma))
    if (noise=="exp")
      nd <- cbind(nd,rexp(nnoise,1/noisesigma))
  }
  if (noise=="normix")
      nd <- cbind(nd,normixdata(nnoise/12,subclasses=12,meanvec=-5:5))
  sim <- cbind(rbind(cld12,rd12),nd)
  sim
}

set.seed(300)
test <- simdata(cluster="normal",rest="normix")
# n=300, p=4, Normal mixture mit 11 Klassen, 10 davon mit recht aehnlichen
# Kov-Matrizen, 11. Klasse (Pt. 1-100) mit groesserer Varianz in Dim. 1
# und 2, sphaerisch. 
test2 <- test[,1:2]
# ...jetzt, von oben:
pams <- list()
avsilwidth <- c()
maxk <- 15
for(k in 2:maxk){
  pams[[k]] <- pam(test,k)
  avsilwidth <- c(avsilwidth,pams[[k]]$silinfo$avg.width)
}
kopt <- order(avsilwidth)[maxcn-1]+1
# kopt ist 2, grauenhaft.
plot(test,pch=pams[[kopt]]$clustering)
pams2 <- list()
avsilwidth <- c()
maxk <- 15
for(k in 2:maxk){
  pams2[[k]] <- pam(test,k)
  avsilwidth <- c(avsilwidth,pams2[[k]]$silinfo$avg.width)
}
kopt <- order(avsilwidth)[maxcn-1]+1
# kopt ist 9. Etwas besser, aber...
plot(test2,pch=pams2[[kopt]]$clustering)
plot(test2,pch=pams2[[12]]$clustering)
# ... ueberzeugt entschieden mehr.

Gruss,
Christian

On Thu, 5 Sep 2002, Martin Maechler wrote:

> Lieber Christian,
> 
> könntest Du vielleicht etwas formulieren, was man in 
> help(pam)  dazufügen könnte zum Thema "Silhouette Index" ?
> 
> Die aktuelle pam Dokumentation ist in 
>     /u/maechler/R/Pkgs/cluster/man/pam.Rd
> und /u/maechler/R/Pkgs/cluster/man/pam.object.Rd
> 
> {Die momentan aktuelle Version von "cluster", 1.6-0,
>  ist seit gestern bei uns installiert, aber noch nicht auf CRAN}
> 
> Vielen Dank im voraus!
> Martin
> 

-- 
***********************************************************************
Christian Hennig
Seminar fuer Statistik, ETH-Zentrum (LEO), CH-8092 Zuerich (current)
and Fachbereich Mathematik-SPST/ZMS, Universitaet Hamburg
hennig@stat.math.ethz.ch, http://stat.ethz.ch/~hennig/
hennig@math.uni-hamburg.de, http://www.math.uni-hamburg.de/home/hennig/
#######################################################################
ich empfehle www.boag.de


